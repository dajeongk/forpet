<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.forpet.mapper.AdminChartMapper">

	<!-- 1차 카테고리 이름별 매출 통계 -->
	<select id="primaryChart" resultType="com.forpet.domain.ChartVO">
	
		SELECT 
			C.CTG_NAME AS primary_code, SUM(OD.ODR_PRICE) AS sales_p
  		FROM 
  			PRODUCT_TBL P, ORDER_DETAIL_TBL OD, 
    		(SELECT C2.CTG_NAME, C1.CTG_CODE 
    		 FROM CATEGORY_TBL C1, CATEGORY_TBL C2 
    		 WHERE C1.CTG_CODE_PRT = C2.CTG_CODE) C
  		WHERE 
  			P.PDT_NUMBER = OD.PDT_NUMBER AND P.CTG_CODE = C.CTG_CODE
  		GROUP BY 
  			C.CTG_NAME
  		ORDER BY 
  			C.CTG_NAME
		
	</select>


</mapper>